!function(){"use strict";angular.module("angularjs-datetime-picker",[]);var e=function(e,t,a){var n=a("DatetimePickerCtrl");return{open:function(e){n.openDatetimePicker(e)},close:function(){n.closeDatetimePicker()}}};e.$inject=["$compile","$document","$controller"],angular.module("angularjs-datetime-picker").factory("DatetimePicker",e);var t=function(e,t){var a,n=this,l=function(e){e&&e.remove(),t[0].body.removeEventListener("click",n.closeDatetimePicker)};this.openDatetimePicker=function(n){this.closeDatetimePicker();var l=angular.element("<div datetime-picker-popup ng-cloak></div>");n.dateFormat&&l.attr("date-format",n.dateFormat),n.ngModel&&l.attr("ng-model",n.ngModel),n.year&&l.attr("year",parseInt(n.year)),n.month&&l.attr("month",parseInt(n.month)),n.day&&l.attr("day",parseInt(n.day)),n.hour&&l.attr("hour",parseInt(n.hour)),n.minute&&l.attr("minute",parseInt(n.minute)),""!==n.dateOnly&&!0!==n.dateOnly||l.attr("date-only","true"),"false"===n.closeOnSelect&&l.attr("close-on-select","false");var i=n.triggerEl;n.scope=n.scope||angular.element(i).scope(),(a=e(l)(n.scope)[0]).triggerEl=n.triggerEl,t[0].body.appendChild(a);var r=i.getBoundingClientRect();n.scope.$apply();var o=a.getBoundingClientRect();a.style.position="absolute",r.width>o.width?a.style.left=r.left+r.width-o.width+window.scrollX+"px":a.style.left=r.left+window.scrollX+"px",r.top<300||window.innerHeight-r.bottom>300?a.style.top=r.bottom+window.scrollY+"px":a.style.top=r.top-o.height+window.scrollY+"px",t[0].body.addEventListener("click",this.closeDatetimePicker)},this.closeDatetimePicker=function(e){var a=e&&e.target,n=t[0].querySelector("div[datetime-picker-popup]");e&&a&&(a.hasAttribute("datetime-picker")||n&&n.contains(a))||l(n)}};t.$inject=["$compile","$document"],angular.module("angularjs-datetime-picker").controller("DatetimePickerCtrl",t);var a=['<div class="angularjs-datetime-picker">','  <div class="adp-month">','    <button type="button" class="adp-prev" ng-click="addMonth(-1)">&laquo;</button>','    <span title="{{months[mv.month].fullName}}">{{months[mv.month].shortName}}</span> {{mv.year}}','    <button type="button" class="adp-next" ng-click="addMonth(1)">&raquo;</button>',"  </div>",'  <div class="adp-days" ng-click="setDate($event)">','    <div class="adp-day-of-week" ng-repeat="dayOfWeek in ::daysOfWeek" title="{{dayOfWeek.fullName}}">{{::dayOfWeek.firstLetter}}</div>','    <div class="adp-day" ng-show="mv.leadingDays.length < 7" ng-repeat="day in mv.leadingDays">{{::day}}</div>','    <div class="adp-day selectable" ng-repeat="day in mv.days" ',"      today=\"{{today}}\" d2=\"{{mv.year + '-' + (mv.month + 1) + '-' + day}}\"",'      ng-class="{',"        selected: (day == selectedDay),","        today: (today == (mv.year + '-' + (mv.month + 1) + '-' + day)),","        weekend: (mv.leadingDays.length + day)%7 == 1 || (mv.leadingDays.length + day)%7 == 0",'      }">',"      {{::day}}","    </div>",'    <div class="adp-day" ng-show="mv.trailingDays.length < 7" ng-repeat="day in mv.trailingDays">{{::day}}</div>',"  </div>",'  <div class="adp-days" id="adp-time"> ','    <label class="timeLabel">Time:</label> <span class="timeValue">{{("0"+inputHour).slice(-2)}} : {{("0"+inputMinute).slice(-2)}} : {{("0"+inputSecond).slice(-2)}}</span><br/>','    <label class="hourLabel">Hour:</label> <input class="hourInput" type="range" min="0" max="23" ng-model="inputHour" ng-change="updateNgModel()" />','    <label class="minutesLabel">Min:</label> <input class="minutesInput" type="range" min="0" max="59" ng-model="inputMinute"  ng-change="updateNgModel()"/> ','    <label class="secondsLabel">Sec:</label> <input class="minutesInput" type="range" min="0" max="59" ng-model="inputSecond"  ng-change="updateNgModel()"/> ',"  </div> ","</div>"].join("\n"),n=function(e,t){var n,l,i,r,o=function(e,t){t>11?e++:t<0&&e--,t=(t+12)%12;var a=new Date(e,t,1),l=new Date(e,t+1,0),i=new Date(e,t,0),o=l.getDate(),d=i.getDate(),s=(a.getDay()-r+7)%7||7,c=n.slice(0,42-(s+o));return c.length>7&&(c=c.slice(0,c.length-7)),{year:e,month:t,days:n.slice(0,o),leadingDays:n.slice(-s-(31-d),d),trailingDays:c}};return{restrict:"A",template:a,controller:"DatetimePickerCtrl",replace:!0,scope:{year:"=",month:"=",day:"=",hour:"=",minute:"=",second:"=",dateOnly:"=",closeOnSelect:"="},link:function(a,d,s,c){!function(){n=[],l=[],i=[],r=0;for(var t=1;t<=31;t++)n.push(t);for(t=0;t<12;t++)l.push({fullName:e.DATETIME_FORMATS.MONTH[t],shortName:e.DATETIME_FORMATS.SHORTMONTH[t]});for(t=0;t<7;t++){var a=e.DATETIME_FORMATS.DAY[(t+r)%7];i.push({fullName:a,firstLetter:a.substr(0,1)})}r=0}();var u=s.dateFormat||"short";a.months=l,a.daysOfWeek=i,a.inputHour,a.inputMinute,a.inputSecond,!0===a.dateOnly&&(d[0].querySelector("#adp-time").style.display="none"),a.$applyAsync(function(){if(c.triggerEl=angular.element(d[0].triggerEl),s.ngModel){var e=""+c.triggerEl.scope().$eval(s.ngModel);if(e){e.match(/[0-9]{2}:/)||(e+=" 00:00:00"),e=(e=(e=(e=(e=e.replace(/([0-9]{2}-[0-9]{2})-([0-9]{4})/,"$2-$1")).replace(/([\/-][0-9]{2,4})\ ([0-9]{2}\:[0-9]{2}\:)/,"$1T$2")).replace(/EDT|EST|CDT|CST|MDT|PDT|PST|UT|GMT/g,"")).replace(/\s*\(\)\s*/,"")).replace(/[\-\+][0-9]{2}:?[0-9]{2}$/,""),e+=function(e){"string"==typeof e&&(e=new Date(e));var t=new Date(e.getFullYear(),0,1),a=new Date(e.getFullYear(),6,1),n=Math.max(t.getTimezoneOffset(),a.getTimezoneOffset()),l=e.getTimezoneOffset()<n?n-60:n;return(l>=0?"-":"+")+("0"+l/60).slice(-2)+":"+("0"+l%60).slice(-2)}(e);var n=new Date(e);a.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())}}if(!a.selectedDate||isNaN(a.selectedDate.getTime())){var l=new Date,i=a.year||l.getFullYear(),r=a.month?a.month-1:l.getMonth(),u=a.day||l.getDate(),m=a.hour||l.getHours(),g=a.minute||l.getMinutes(),p=a.second||l.getSeconds();a.selectedDate=new Date(i,r,u,m,g,p)}a.inputHour=a.selectedDate.getHours(),a.inputMinute=a.selectedDate.getMinutes(),a.inputSecond=a.selectedDate.getSeconds(),a.mv=o(a.selectedDate.getFullYear(),a.selectedDate.getMonth()),a.today=t(new Date,"yyyy-M-d"),a.mv.year==a.selectedDate.getFullYear()&&a.mv.month==a.selectedDate.getMonth()?a.selectedDay=a.selectedDate.getDate():a.selectedDay=null}),a.addMonth=function(e){a.mv=o(a.mv.year,a.mv.month+e)},a.setDate=function(e){var t=angular.element(e.target)[0];-1!==t.className.indexOf("selectable")&&(a.updateNgModel(parseInt(t.innerHTML)),!1!==a.closeOnSelect&&c.closeDatetimePicker())},a.updateNgModel=function(e){if(e=e||a.selectedDate.getDate(),a.selectedDate=new Date(a.mv.year,a.mv.month,e,a.inputHour,a.inputMinute,a.inputSecond),a.selectedDay=a.selectedDate.getDate(),s.ngModel){var n,l=c.triggerEl.scope();n=l.$eval(s.ngModel)&&"Date"===l.$eval(s.ngModel).constructor.name?new Date(t(a.selectedDate,u)):t(a.selectedDate,u),l.$eval(s.ngModel+"= date",{date:n})}},a.$on("$destroy",c.closeDatetimePicker)}}};n.$inject=["$locale","dateFilter"],angular.module("angularjs-datetime-picker").directive("datetimePickerPopup",n);var l=function(e,t){return{require:"ngModel",link:function(e,a,n,l){e.$watch(n.ngModel,function(e){if(e&&""!=e){var t=new Date(e);l.$setValidity("date",!!t);var a=new Date;n.hasOwnProperty("futureOnly")&&l.$setValidity("future-only",!(t<a))}}),a[0].addEventListener("click",function(){t.open({triggerEl:a[0],dateFormat:n.dateFormat,ngModel:n.ngModel,year:n.year,month:n.month,day:n.day,hour:n.hour,minute:n.minute,second:n.second,dateOnly:n.dateOnly,futureOnly:n.futureOnly,closeOnSelect:n.closeOnSelect})})}}};l.$inject=["$parse","DatetimePicker"],angular.module("angularjs-datetime-picker").directive("datetimePicker",l)}();
